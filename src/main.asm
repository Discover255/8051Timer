		ORG  0000H
		LJMP MAIN
		ORG  000BH
		LJMP INT
		ORG  0030H
MAIN: 	MOV  R0,#0
		MOV  R1,#0
		MOV  R2,#0
		MOV  R3,#0
		MOV  R4,#5
		MOV  R5,#1
		MOV  R6,#5
		MOV  R7,#0
		SETB RS1
		MOV  R2,#0
		CLR  RS1
		MOV  TMOD,#01H
		MOV  TL0,#1
		MOV  TH0,#240
		SETB TR0
		SETB ET0
		SETB EA
		;seraching here can be binary searching
		LJMP IF0
IF0:	CJNE R7,#255,LOOP1
		MOV  R7,#0
		CALL TIMEDEC
		CPL	 P1.0
LOOP1:	NOP
IF2:	CJNE R0,#0,ELIF21
		MOV  A,R1
		LJMP BREAK1
ELIF21:	CJNE R0,#1,ELIF22
		MOV  A,R2
		LJMP BREAK1
ELIF22:	CJNE R0,#2,ELIF23
		MOV  A,R3
		LJMP BREAK1
ELIF23:	CJNE R0,#3,ELIF24
		MOV  A,R4
		LJMP BREAK1
ELIF24:	CJNE R0,#4,ELSE2
		MOV  A,R5
		LJMP BREAK1
ELSE2:	MOV  A,R6
BREAK1:	MOV  DPTR,#SEGTAB
		MOVC A,@A+DPTR
		SETB P2.6
		MOV  P0,A
		CLR  P2.6
		MOV  DPTR,#SELECT
		MOV  A,R0
		MOVC A,@A+DPTR
		SETB P2.7
		MOV  P0,A
		CLR  P2.7
		LCALL FLICK
		JB   00H,IF15;sometimes flagbit read is wrong
		JB   P3.0,BREAK16
		SETB 01H
BREAK16:JNB  01H,BREAK17
		JNB  P3.0,BREAK17
		SETB 02H
BREAK17:SETB RS1
		CJNE R2,#5,ELSE18
		MOV  R2,#0
		CLR  01H
		CLR  02H
		JNB  P3.0,KEYUP01
		CLR  02H
		CPL  P1.3
		CLR  RS1
		LJMP BREAK18
KEYUP01:SETB 02H
		CLR  RS1
		LJMP BREAK18
ELSE18: JC   BREAK18
		MOV  R2,#0
		CLR  01H
		CLR  02H
		JNB  P3.0,KEYUP02
		CLR  02H
		CPL  P1.3
		CLR  RS1
		LJMP BREAK18
KEYUP02:SETB 02H
		CLR  RS1
		LJMP BREAK18
BREAK18:JB   02H,BREAK19
		CLR  02H
BREAK19:SETB RS1
		CJNE R2,#0,SWITCH1
		CLR  RS1
		LJMP IF15
SWITCH1:NOP
CASE1:	CJNE R2,#1,CASE2
		CLR  RS1
		LCALL SKIPH
		SJMP IF15
CASE2:  CJNE R2,#2,CASE3
		CLR  RS1
		LCALL SKIPM
		SJMP IF15
CASE3:  CJNE R2,#3,IF15
		CLR  RS1
		LCALL SKIPS
		SJMP IF15
IF15:	SETB RS1
		MOV  A,#1
		CJNE A,10H,IF9
		LJMP RESET1
IF9:	JNC  IF10
RESET1: MOV  R0,#0
		CLR  RS1
		LCALL INDEX
IF10:	CLR  RS1
		LJMP IF0
TIMEDEC:NOP
IF3:	CJNE R6,#0,ELSE3
IF4:	CJNE R5,#0,ELSE4
IF5:	CJNE R4,#0,ELSE5
IF6:	CJNE R3,#0,ELSE6
IF7:	CJNE R2,#0,ELSE7
IF8:	CJNE R1,#0,ELSE8
		CLR  P2.3
		RET
ELSE8:	DEC	 R1
		LJMP BORROW2
ELSE7:	DEC  R2
		LJMP BORROW3
ELSE6:	DEC  R3
		LJMP BORROW4
ELSE5:	DEC  R4
		LJMP BORROW5
ELSE4:	DEC  R5
		LJMP BORROW6
ELSE3:	DEC  R6
		RET
BORROW2:MOV  R2,#9
BORROW3:MOV  R3,#5
BORROW4:MOV  R4,#9
BORROW5:MOV  R5,#5
BORROW6:MOV  R6,#9
		RET
INT:	NOP
		MOV  TL0,#1
		MOV  TH0,#240
		INC  R7
		JB   RS1,KEEPRS1
		JNB  RS0,KEEPRS01
		SETB RS1
		CLR  RS0
		INC  R0
		INC  R1
		JNB  02H,QUITINT1
		INC  R2
QUITINT1:CLR  RS1
		SETB RS0
		RETI
KEEPRS01:	SETB RS1
			INC  R0
			INC  R1
			JNB  02H,QUITINT2
			INC  R2
QUITINT2:	CLR  RS1
			RETI
KEEPRS1:JNB RS0,KEEPRS02
		CLR  RS0
		INC  R0
		INC  R1
		JNB  02H,QUITINT3
		INC  R2
		RETI
QUITINT3:SETB RS0
KEEPRS02:	INC  R0
			INC  R1
			JNB  02H,QUITINT4
			INC  R2
QUITINT4:	RETI
INDEX:  INC  R0
		MOV  A,#6
		CJNE A,00H,CHECK1
		MOV  R0,#0
		SJMP RETURN1
CHECK1: JNC  RETURN1
		MOV  R0,#0
RETURN1:RET
SKIPH:  CJNE R0,#0,IF11
		LCALL INDEX
IF11:	CJNE R0,#1,RETURN2
		LCALL INDEX
RETURN2:RET
SKIPM:  CJNE R0,#2,IF12
		LCALL INDEX
IF12:	CJNE R0,#3,RETURN3
		LCALL INDEX
RETURN3:RET
SKIPS:  CJNE R0,#4,IF13
		LCALL INDEX
IF13:	CJNE R0,#5,RETURN4
		LCALL INDEX
RETURN4:RET
FLICK:  SETB RS1
		MOV  A,#50
		CJNE A,11H,IF14
		SJMP RESET2
		RET
IF14:   JNC  RETURN5
RESET2: NOP
		CPL  00H
		MOV  R1,#0
		CLR  RS1
RETURN5:CLR  RS1
		RET
MOVSELECT:	SETB RS1
			CJNE R2,#3,IF20
INITR7:		MOV  R2,#0
			CLR  RS1
			RET
IF20:		JC   INCR7
			SJMP INITR7
INCR7:		INC  R7
			CLR  RS1
			RET
;in this way,I can't hide all dig
SEGTAB:		 DB 3FH,06H,5BH,4FH,66H,6DH,7DH,07H,7FH,6FH
SELECT: 	 DB 11111110B,11111101B,11111011B,11110111B,11101111B,11011111B
END